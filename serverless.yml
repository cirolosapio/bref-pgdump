service: bref-pgdump

provider:
  name: aws
  region: eu-central-1
  stage: prod
  ecr:
    images:
      php-fpm-83-pgdump:
        path: ./Dockerfile.fpm.prod
      php-console-83-pgdump:
        path: ./Dockerfile.console.prod
  environment:
    APP_KEY: ${ssm:/${self:service}/APP_KEY}
    BREF_BINARY_RESPONSES: "1"
  apiGateway:
    binaryMediaTypes:
      - "*/*"

package:
  patterns:
    - "!.devcontainer/**"
    - "!.github/**"
    - "!.vscode/**"
    - "!public/vendor"
    - "!tests/**"
    - "!.editorconfig"
    - "!.env.example"
    - "!.gitattributes"
    - "!.php-cs-fixer.dist.php"
    - "!phpunit.xml"
    - "!README.md"

functions:
  web:
    runtime: php-fpm-83-pgdump
    architecture: arm64
    url: true

  artisan:
    runtime: php-console-83-pgdump
    architecture: arm64

plugins:
  - ./vendor/bref/bref
